<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · TranscodingStreams.jl</title><meta name="title" content="Reference · TranscodingStreams.jl"/><meta property="og:title" content="Reference · TranscodingStreams.jl"/><meta property="twitter:title" content="Reference · TranscodingStreams.jl"/><meta name="description" content="Documentation for TranscodingStreams.jl."/><meta property="og:description" content="Documentation for TranscodingStreams.jl."/><meta property="twitter:description" content="Documentation for TranscodingStreams.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TranscodingStreams.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li class="is-active"><a class="tocitem" href>Reference</a><ul class="internal"><li><a class="tocitem" href="#TranscodingStream"><span>TranscodingStream</span></a></li><li><a class="tocitem" href="#Statistics"><span>Statistics</span></a></li><li><a class="tocitem" href="#Codec"><span>Codec</span></a></li><li><a class="tocitem" href="#Internal-types"><span>Internal types</span></a></li></ul></li><li><a class="tocitem" href="../devnotes/">Developer&#39;s notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaIO/TranscodingStreams.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/master/docs/src/reference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h1><h2 id="TranscodingStream"><a class="docs-heading-anchor" href="#TranscodingStream">TranscodingStream</a><a id="TranscodingStream-1"></a><a class="docs-heading-anchor-permalink" href="#TranscodingStream" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.TranscodingStream-Tuple{TranscodingStreams.Codec, IO}" href="#TranscodingStreams.TranscodingStream-Tuple{TranscodingStreams.Codec, IO}"><code>TranscodingStreams.TranscodingStream</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">TranscodingStream(codec::Codec, stream::IO;
                  bufsize::Integer=16384,
                  stop_on_end::Bool=false,
                  sharedbuf::Bool=(stream isa TranscodingStream))</code></pre><p>Create a transcoding stream with <code>codec</code> and <code>stream</code>.</p><p>A <code>TranscodingStream</code> object wraps an input/output stream object <code>stream</code>, and transcodes the byte stream using <code>codec</code>. It is a subtype of <code>IO</code> and supports most of the I/O functions in the standard library.</p><p>See the docs (<a href="https://bicycle1885.github.io/TranscodingStreams.jl/stable/">https://bicycle1885.github.io/TranscodingStreams.jl/stable/</a>) for available codecs, examples, and more details of the type.</p><p><strong>Arguments</strong></p><ul><li><code>codec</code>:   The data transcoder. The transcoding stream does the initialization and   finalization of <code>codec</code>. Therefore, a codec object is not reusable once it   is passed to a transcoding stream.</li><li><code>stream</code>:   The wrapped stream. It must be opened before passed to the constructor.</li><li><code>bufsize</code>:   The initial buffer size (the default size is 16KiB). The buffer may be   extended whenever <code>codec</code> requests so.</li><li><code>stop_on_end</code>:   The flag to stop transcoding on <code>:end</code> return code from <code>codec</code>.  The   transcoded data are readable even after stopping transcoding process.  With   this flag on, <code>stream</code> is not closed when the wrapper stream is closed with   <code>close</code>.  Note that some extra data may be read from <code>stream</code> into an   internal buffer, and thus <code>stream</code> must be a <code>TranscodingStream</code> object and   <code>sharedbuf</code> must be <code>true</code> to reuse <code>stream</code>.</li><li><code>sharedbuf</code>:   The flag to share buffers between adjacent transcoding streams.  The value   must be <code>false</code> if <code>stream</code> is not a <code>TranscodingStream</code> object.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using TranscodingStreams

julia&gt; file = open(joinpath(dirname(dirname(pathof(TranscodingStreams))), &quot;README.md&quot;));

julia&gt; stream = NoopStream(file);

julia&gt; readline(file)
&quot;TranscodingStreams.jl&quot;

julia&gt; close(stream)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/stream.jl#L56-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.transcode" href="#Base.transcode"><code>Base.transcode</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">transcode(
    ::Type{C},
    data::Union{Vector{UInt8},Base.CodeUnits{UInt8}},
)::Vector{UInt8} where {C&lt;:Codec}</code></pre><p>Transcode <code>data</code> by applying a codec <code>C()</code>.</p><p>Note that this method does allocation and deallocation of <code>C()</code> in every call, which is handy but less efficient when transcoding a number of objects. <code>transcode(codec, data)</code> is a recommended method in terms of performance.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">julia&gt; using CodecZlib

julia&gt; data = b&quot;abracadabra&quot;;

julia&gt; compressed = transcode(ZlibCompressor, data);

julia&gt; decompressed = transcode(ZlibDecompressor, compressed);

julia&gt; String(decompressed)
&quot;abracadabra&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/transcode.jl#L4-L31">source</a></section><section><div><pre><code class="language-julia hljs">transcode(
    codec::Codec,
    data::Union{Vector{UInt8},Base.CodeUnits{UInt8},Buffer},
    [output::Union{Vector{UInt8},Base.CodeUnits{UInt8},Buffer}],
)::Vector{UInt8}</code></pre><p>Transcode <code>data</code> by applying <code>codec</code>.</p><p>If <code>output</code> is unspecified, then this method will allocate it.</p><p>Note that this method does not initialize or finalize <code>codec</code>. This is efficient when you transcode a number of pieces of data, but you need to call <a href="#TranscodingStreams.initialize"><code>TranscodingStreams.initialize</code></a> and <a href="#TranscodingStreams.finalize"><code>TranscodingStreams.finalize</code></a> explicitly.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">julia&gt; using CodecZlib

julia&gt; data = b&quot;abracadabra&quot;;

julia&gt; codec = ZlibCompressor();

julia&gt; TranscodingStreams.initialize(codec)

julia&gt; compressed = Vector{UInt8}()

julia&gt; transcode(codec, data, compressed);

julia&gt; TranscodingStreams.finalize(codec)

julia&gt; codec = ZlibDecompressor();

julia&gt; TranscodingStreams.initialize(codec)

julia&gt; decompressed = transcode(codec, compressed);

julia&gt; TranscodingStreams.finalize(codec)

julia&gt; String(decompressed)
&quot;abracadabra&quot;
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/transcode.jl#L55-L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.unsafe_transcode!" href="#TranscodingStreams.unsafe_transcode!"><code>TranscodingStreams.unsafe_transcode!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">unsafe_transcode!(output::Buffer, codec::Codec, input::Buffer)</code></pre><p>Transcode <code>input</code> by applying <code>codec</code> and storing the results in <code>output</code> without validation of input or output.  Note that this method does not initialize or finalize <code>codec</code>. This is efficient when you transcode a number of pieces of data, but you need to call <a href="#TranscodingStreams.initialize"><code>TranscodingStreams.initialize</code></a> and <a href="#TranscodingStreams.finalize"><code>TranscodingStreams.finalize</code></a> explicitly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/transcode.jl#L131-L139">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.transcode!" href="#TranscodingStreams.transcode!"><code>TranscodingStreams.transcode!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">transcode!(output::Buffer, codec::Codec, input::Buffer)</code></pre><p>Transcode <code>input</code> by applying <code>codec</code> and storing the results in <code>output</code> with validation of input and output.  Note that this method does not initialize or finalize <code>codec</code>. This is efficient when you transcode a number of pieces of data, but you need to call <a href="#TranscodingStreams.initialize"><code>TranscodingStreams.initialize</code></a> and <a href="#TranscodingStreams.finalize"><code>TranscodingStreams.finalize</code></a> explicitly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/transcode.jl#L111-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.TOKEN_END" href="#TranscodingStreams.TOKEN_END"><code>TranscodingStreams.TOKEN_END</code></a> — <span class="docstring-category">Constant</span></header><section><div><p>A special token indicating the end of data.</p><p><code>TOKEN_END</code> may be written to a transcoding stream like <code>write(stream, TOKEN_END)</code>, which will terminate the current transcoding block.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Call <code>flush(stream)</code> after <code>write(stream, TOKEN_END)</code> to make sure that all data are written to the underlying stream.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/stream.jl#L485-L495">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.unsafe_read" href="#TranscodingStreams.unsafe_read"><code>TranscodingStreams.unsafe_read</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">unsafe_read(input::IO, output::Ptr{UInt8}, nbytes::Int)::Int</code></pre><p>Copy at most <code>nbytes</code> from <code>input</code> into <code>output</code>.</p><p>This function is similar to <code>Base.unsafe_read</code> but is different in some points:</p><ul><li>It does not throw <code>EOFError</code> when it fails to read <code>nbytes</code> from <code>input</code>.</li><li>It returns the number of bytes written to <code>output</code>.</li><li>It does not block if there are buffered data in <code>input</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/io.jl#L4-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.unread" href="#TranscodingStreams.unread"><code>TranscodingStreams.unread</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">unread(stream::TranscodingStream, data::Vector{UInt8})</code></pre><p>Insert <code>data</code> to the current reading position of <code>stream</code>.</p><p>The next <code>read(stream, sizeof(data))</code> call will read data that are just inserted.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/stream.jl#L409-L416">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.unsafe_unread" href="#TranscodingStreams.unsafe_unread"><code>TranscodingStreams.unsafe_unread</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">unsafe_unread(stream::TranscodingStream, data::Ptr, nbytes::Integer)</code></pre><p>Insert <code>nbytes</code> pointed by <code>data</code> to the current reading position of <code>stream</code>.</p><p>The data are copied into the internal buffer and hence <code>data</code> can be safely used after the operation without interfering the stream.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/stream.jl#L421-L428">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.position-Tuple{TranscodingStream}" href="#Base.position-Tuple{TranscodingStream}"><code>Base.position</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">position(stream::TranscodingStream)</code></pre><p>Return the number of bytes read from or written to <code>stream</code>.</p><p>Note that the returned value will be different from that of the underlying stream wrapped by <code>stream</code>.  This is because <code>stream</code> buffers some data and the codec may change the length of data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/stream.jl#L258-L266">source</a></section></article><h2 id="Statistics"><a class="docs-heading-anchor" href="#Statistics">Statistics</a><a id="Statistics-1"></a><a class="docs-heading-anchor-permalink" href="#Statistics" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.Stats" href="#TranscodingStreams.Stats"><code>TranscodingStreams.Stats</code></a> — <span class="docstring-category">Type</span></header><section><div><p>I/O statistics.</p><p>Its object has four fields:</p><ul><li><code>in</code>: the number of bytes supplied into the stream</li><li><code>out</code>: the number of bytes consumed out of the stream</li><li><code>transcoded_in</code>: the number of bytes transcoded from the input buffer</li><li><code>transcoded_out</code>: the number of bytes transcoded to the output buffer</li></ul><p>Note that, since the transcoding stream does buffering, <code>in</code> is <code>transcoded_in + {size of buffered data}</code> and <code>out</code> is <code>transcoded_out - {size of buffered data}</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/stream.jl#L518-L530">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.stats" href="#TranscodingStreams.stats"><code>TranscodingStreams.stats</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">stats(stream::TranscodingStream)</code></pre><p>Create an I/O statistics object of <code>stream</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/stream.jl#L546-L550">source</a></section></article><h2 id="Codec"><a class="docs-heading-anchor" href="#Codec">Codec</a><a id="Codec-1"></a><a class="docs-heading-anchor-permalink" href="#Codec" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.Noop" href="#TranscodingStreams.Noop"><code>TranscodingStreams.Noop</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Noop()</code></pre><p>Create a noop codec.</p><p>Noop (no operation) is a codec that does nothing. The data read from or written to the stream are kept as-is without any modification. This is often useful as a buffered stream or an identity element of a composition of streams.</p><p>The implementations are specialized for this codec. For example, a <code>Noop</code> stream uses only one buffer rather than a pair of buffers, which avoids copying data between two buffers and the throughput will be larger than a naive implementation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/noop.jl#L4-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.NoopStream" href="#TranscodingStreams.NoopStream"><code>TranscodingStreams.NoopStream</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">NoopStream(stream::IO)</code></pre><p>Create a noop stream.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/noop.jl#L22-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.position-Tuple{NoopStream}" href="#Base.position-Tuple{NoopStream}"><code>Base.position</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">position(stream::NoopStream)</code></pre><p>Get the current poition of <code>stream</code>.</p><p>Note that this method may return a wrong position when</p><ul><li>some data have been inserted by <code>TranscodingStreams.unread</code>, or</li><li>the position of the wrapped stream has been changed outside of this package.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/noop.jl#L44-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.Codec" href="#TranscodingStreams.Codec"><code>TranscodingStreams.Codec</code></a> — <span class="docstring-category">Type</span></header><section><div><p>An abstract codec type.</p><p>Any codec supporting the transcoding protocol must be a subtype of this type.</p><p><strong>Transcoding protocol</strong></p><p>Transcoding proceeds by calling some functions in a specific way. We call this &quot;transcoding protocol&quot; and any codec must implement it as described below.</p><p>There are six functions for a codec to implement:</p><ul><li><code>expectedsize</code>: return the expected size of transcoded data</li><li><code>minoutsize</code>: return the minimum output size of <code>process</code></li><li><code>initialize</code>: initialize the codec</li><li><code>finalize</code>: finalize the codec</li><li><code>startproc</code>: start processing with the codec</li><li><code>process</code>: process data with the codec.</li></ul><p>These are defined in the <code>TranscodingStreams</code> and a new codec type must extend these methods if necessary.  Implementing a <code>process</code> method is mandatory but others are optional.  <code>expectedsize</code>, <code>minoutsize</code>, <code>initialize</code>, <code>finalize</code>, and <code>startproc</code> have a default implementation.</p><p>Your codec type is denoted by <code>C</code> and its object by <code>codec</code>.</p><p>Errors that occur in these methods are supposed to be unrecoverable and the stream will go to the panic mode. Only <code>Base.isopen</code> and <code>Base.close</code> are available in that mode.</p><p><strong><code>expectedsize</code></strong></p><p>The <code>expectedsize(codec::C, input::Memory)::Int</code> method takes <code>codec</code> and <code>input</code>, and returns the expected size of transcoded data. This method will be used as a hint to determine the size of a data buffer when <code>transcode</code> is called. A good hint will reduce the number of buffer resizing and hence result in better performance.</p><p><strong><code>minoutsize</code></strong></p><p>The <code>minoutsize(codec::C, input::Memory)::Int</code> method takes <code>codec</code> and <code>input</code>, and returns the minimum required size of the output memory when <code>process</code> is called.  For example, an encoder of base64 will write at least four bytes to the output and hence it is reasonable to return 4 with this method.</p><p><strong><code>initialize</code></strong></p><p>The <code>initialize(codec::C)::Void</code> method takes <code>codec</code> and returns <code>nothing</code>. This is called once and only once before starting any data processing. Therefore, you may initialize <code>codec</code> (e.g. allocating memory needed to process data) with this method. If initialization fails for some reason, it may throw an exception and no other methods (including <code>finalize</code>) will be called. Therefore, you need to release the memory before throwing an exception.</p><p><strong><code>finalize</code></strong></p><p>The <code>finalize(codec::C)::Void</code> method takes <code>codec</code> and returns <code>nothing</code>.  This is called once and only only once just before the transcoding stream goes to the close mode (i.e. when <code>Base.close</code> is called) or just after <code>startproc</code> or <code>process</code> throws an exception. Other errors that happen inside the stream (e.g. <code>EOFError</code>) will not call this method. Therefore, you may finalize <code>codec</code> (e.g. freeing memory) with this method. If finalization fails for some reason, it may throw an exception. You should release the allocated memory in codec before returning or throwing an exception in <code>finalize</code> because otherwise nobody cannot release the memory. Even when an exception is thrown while finalizing a stream, the stream will become the close mode for safety.</p><p><strong><code>startproc</code></strong></p><p>The <code>startproc(codec::C, mode::Symbol, error::Error)::Symbol</code> method takes <code>codec</code>, <code>mode</code> and <code>error</code>, and returns a status code. This is called just before the stream starts reading or writing data. <code>mode</code> is either <code>:read</code> or <code>:write</code> and then the stream starts reading or writing, respectively.  The return code must be <code>:ok</code> if <code>codec</code> is ready to read or write data.  Otherwise, it must be <code>:error</code> and the <code>error</code> argument must be set to an exception object.</p><p><strong><code>process</code></strong></p><p>The <code>process(codec::C, input::Memory, output::Memory, error::Error)::Tuple{Int,Int,Symbol}</code> method takes <code>codec</code>, <code>input</code>, <code>output</code> and <code>error</code>, and returns a consumed data size, a produced data size and a status code. This is called repeatedly while processing data. The input (<code>input</code>) and output (<code>output</code>) data are a <code>Memory</code> object, which is a pointer to a contiguous memory region with size. You must read input data from <code>input</code>, transcode the bytes, and then write the output data to <code>output</code>.  Finally you need to return the size of read data, the size of written data, and <code>:ok</code> status code so that the caller can know how many bytes are consumed and produced in the method. When transcoding reaches the end of a data stream, it is notified to this method by empty input. In that case, the method need to write the buffered data (if any) to <code>output</code>. If there is no data to write, the status code must be set to <code>:end</code>. The <code>process</code> method will be called repeatedly until it returns <code>:end</code> status code. If an error happens while processing data, the <code>error</code> argument must be set to an exception object and the return code must be <code>:error</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/codec.jl#L4-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.expectedsize" href="#TranscodingStreams.expectedsize"><code>TranscodingStreams.expectedsize</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">expectedsize(codec::Codec, input::Memory)::Int</code></pre><p>Return the expected size of the transcoded <code>input</code> with <code>codec</code>.</p><p>The default method returns <code>input.size</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/codec.jl#L104-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.minoutsize" href="#TranscodingStreams.minoutsize"><code>TranscodingStreams.minoutsize</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">minoutsize(codec::Codec, input::Memory)::Int</code></pre><p>Return the minimum output size to be ensured when calling <code>process</code>.</p><p>The default method returns <code>max(1, div(input.size, 4))</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/codec.jl#L115-L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.initialize" href="#TranscodingStreams.initialize"><code>TranscodingStreams.initialize</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">initialize(codec::Codec)::Void</code></pre><p>Initialize <code>codec</code>.</p><p>The default method does nothing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/codec.jl#L126-L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.finalize" href="#TranscodingStreams.finalize"><code>TranscodingStreams.finalize</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">finalize(codec::Codec)::Void</code></pre><p>Finalize <code>codec</code>.</p><p>The default method does nothing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/codec.jl#L137-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.startproc" href="#TranscodingStreams.startproc"><code>TranscodingStreams.startproc</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">startproc(codec::Codec, mode::Symbol, error::Error)::Symbol</code></pre><p>Start data processing with <code>codec</code> of <code>mode</code>.</p><p>The default method does nothing and returns <code>:ok</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/codec.jl#L148-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.process" href="#TranscodingStreams.process"><code>TranscodingStreams.process</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">process(codec::Codec, input::Memory, output::Memory, error::Error)::Tuple{Int,Int,Symbol}</code></pre><p>Do data processing with <code>codec</code>.</p><p>There is no default method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/codec.jl#L159-L165">source</a></section></article><h2 id="Internal-types"><a class="docs-heading-anchor" href="#Internal-types">Internal types</a><a id="Internal-types-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.Memory" href="#TranscodingStreams.Memory"><code>TranscodingStreams.Memory</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A contiguous memory.</p><p>This type works like a <code>Vector</code> method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/memory.jl#L4-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.Error" href="#TranscodingStreams.Error"><code>TranscodingStreams.Error</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Container of transcoding error.</p><p>An object of this type is used to notify the caller of an exception that happened inside a transcoding method.  The <code>error</code> field is undefined at first but will be filled when data processing failed. The error should be set by calling the <code>setindex!</code> method (e.g. <code>error[] = ErrorException(&quot;error!&quot;)</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/error.jl#L4-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TranscodingStreams.State" href="#TranscodingStreams.State"><code>TranscodingStreams.State</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A mutable state type of transcoding streams.</p><p>See Developer&#39;s notes for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaIO/TranscodingStreams.jl/blob/6c8e8d18259bf0afc664788f265e037723b7c77a/src/state.jl#L5-L9">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/">« Examples</a><a class="docs-footer-nextpage" href="../devnotes/">Developer&#39;s notes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Friday 3 November 2023 19:29">Friday 3 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
